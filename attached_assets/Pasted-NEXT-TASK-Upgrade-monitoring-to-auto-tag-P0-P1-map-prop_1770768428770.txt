NEXT TASK: Upgrade monitoring to auto-tag P0/P1, map proposals → DecisionBrief fields, and optionally surface “Last reviewed” in UI.

GUARDRAILS
- Do NOT change routing/nav/tab layout.
- Do NOT change paywall/subscription logic.
- FULL FILE REPLACEMENTS ONLY.
- ASK FOR FILES ONE AT A TIME.
- No new dependencies.

ASSUMPTIONS / CONTEXT
- Task A exists: DecisionBrief has lastReviewedAt, updatedAt, confidenceLevel, sourceLinks[], changeLog[].
- There is a monitoring output file (or will be) similar to monitoring/proposals.json OR your in-app monitoring types.
- We will NOT auto-apply P0/P1 updates—only generate proposals + optional patches that require approval.

PHASE 1 — Auto-tag severity (P0/P1/P2) from signals/proposals
1) Create: src/monitoring/severityHeuristics.ts
   Export function:
   - inferSeverity(input: { title: string; excerpt?: string; url?: string; }): "P0"|"P1"|"P2"
   Rules (simple keyword heuristics; conservative):
   - P0 keywords: "suspend", "paused", "terminated", "ban", "no longer", "ineligible", "eligibility", "income requirement", "threshold", "work permit", "work authorization", "sponsorship", "skilled worker", "digital nomad visa requirements", "minimum income", "new law", "decree", "regulation"
   - P1 keywords: "processing time", "appointments", "fees updated", "documentation", "proof", "insurance requirement", "tax guidance", "renewal", "forms"
   - else P2
   Add an override: if excerpt/title contains "effective" + a date-like pattern, bump one level (P2->P1, P1->P0).

2) Update the runner (wherever proposals are generated) so each proposal includes severity from inferSeverity().
   - If you are currently generating proposals in a Node script (scripts/monitoring/hash-monitor.mjs), DO NOT add dependencies; just import/copy the heuristic logic into that script or keep a duplicated minimal version there.
   - If proposals are generated in app code, use the shared severityHeuristics.ts.

PHASE 2 — Map proposals into DecisionBrief meta patches
1) Create: src/monitoring/mapProposalToBriefPatch.ts
   Export:
   - type BriefMetaPatch = Pick<DecisionBrief, "updatedAt"|"confidenceLevel"|"changeLog"> & Partial<Pick<DecisionBrief,"sourceLinks">>
   - function buildMetaPatch(existingBrief, proposal): { patch: Partial<DecisionBrief>, requiresApproval: boolean }
   Rules:
   - updatedAt: set to proposal.detectedAt (or today) for any change
   - lastReviewedAt: DO NOT change (only on approval)
   - changeLog: append { date, summary, severity } (include source URL if your changeLog supports it)
   - confidenceLevel:
       if severity === "P0" -> "low"
       if severity === "P1" -> min("medium", existing) (i.e., downgrade high->medium)
       if severity === "P2" -> unchanged
   - requiresApproval:
       true for P0/P1
       false for P2 (but still do not auto-apply in v1; just mark eligible)

2) Create: src/monitoring/applyApprovedPatch.ts (pure function)
   Export:
   - function applyApprovedPatch(existingBrief, patch, reviewedAtISO): DecisionBrief
   Rules:
   - apply patch fields
   - set lastReviewedAt = reviewedAtISO
   - if patch severity was P0/P1 and now reviewed, allow confidence to be raised manually later (do not auto-raise).

PHASE 3 — Optional UI: show “Last reviewed” (non-intrusive)
ONLY do this if it is easy and doesn’t create duplicate header/body logos.

Implement a tiny component:
- Create: src/components/LastReviewedPill.tsx
  Props: { lastReviewedAt: string; confidenceLevel: "high"|"medium"|"low" }
  Output: small pill text: “Reviewed Feb 2026 • High” using tokens, subtle style.

Then add it ONLY on Decision Brief screens (country hub and/or pathway brief screen) near the top of content.
DO NOT add to Explore or Countries list.

IMPLEMENTATION ORDER (MANDATORY — ASK FOR FILES ONE AT A TIME)
A) Ask me where proposals currently live:
   - Do we have monitoring/proposals.json generated by scripts?
   - Or do we have in-app proposals in src/monitoring already?
   If scripts exist, ask for scripts/monitoring/hash-monitor.mjs content.
B) Create src/monitoring/severityHeuristics.ts (new file).
C) Create src/monitoring/mapProposalToBriefPatch.ts (new file).
D) Create src/monitoring/applyApprovedPatch.ts (new file).
E) OPTIONAL UI:
   - Ask me for the screen file that renders a Decision Brief (the one showing the brief content).
   - Add LastReviewedPill with minimal styling.
STOP after E (or D if UI is skipped) and summarize what changed in 5 bullets.

CRITICAL NOTE
- We are not building persistence, PR automation, or approval UI today.
- We are building the logic so approvals can be handled by PR review or a future admin screen.
